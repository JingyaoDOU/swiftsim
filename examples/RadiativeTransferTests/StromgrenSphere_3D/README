Strömgen Sphere example in 3D
-----------------------------

This directory contains two examples in one:

    -   run a Strömgren sphere example, where a single central
        star ionizes the surrounding medium in a box.
        To run this example, use the provided `run.sh` script.
        This script will then make use of the `makeIC.py` and
        `plotSolution.py` script.

    -   run a propagation test of photons emitted from a single 
        central source in an otherwise uniform box.
        To run this example, use the provided `runPropagationTest.sh` script.
        This script will then make use of the `makePropagationTestIC.py` and
        `plotPhotonPropagationCheck.py` script.


Additional scripts:
    -   `plotRadiationProjection.py`: Plots a projection of the radiation
        quantities (energies, fluxes). NOTE: you might need to change the
        'snapshot_base' variable at the top of the script depending on which
        solutions you want to plot.

    -   `plotStromgren3DsinglebinCheck.py`: Plots the neutral fraction of a pure 
        hydrogen Stromgren Sphere with the grey approximation (single-frequency-bin),
        compared with an analytic solution

    -   `plotStromgren3DMFCheck.py`: Plots the neutral fraction and temperature of a pure 
        hydrogen Stromgren Sphere with three-frequency bins, compared
        with published solutions.

    -   `plotStromgren3DMFHHeCheck.py`: Plots the neutral fraction and temperature of a
        hydrogen (75%) and helium (25%) Stromgren Sphere with three-frequency bins, compared
        with published solutions.        

To use the GEAR RT model, compile with :
    --with-rt=GEAR_1 --with-rt-riemann-solver=GLF --with-hydro=gizmo-mfv --with-riemann-solver=hllc --with-stars=GEAR --with-feedback=none --with-grackle=$GRACKLE_ROOT

To use the SPHM1 RT model, compile with :
for propagation test:
    --with-rt=SPHM1RT_1 --with-stars=basic --with-feedback=none   --with-sundials=$SUNDIALS_ROOT

for Stromgren3D test:
    --with-rt=SPHM1RT_4 --with-stars=basic --with-feedback=none   --with-sundials=$SUNDIALS_ROOT

for Stromgren3D test without dynamics (no acceleration and no velocity):
    --with-rt=SPHM1RT_4 --with-stars=basic --with-feedback=none   --with-sundials=$SUNDIALS_ROOT --enable-boundary-particles=262145 --enable-fixed-boundary-particles=262145 



IMPORTANT: Need SUNDIALS version  > 4 . 
SUNDIALS_ROOT is the root directory that contains the lib and include directories, e.g. on cosma:
SUNDIALS_ROOT=/cosma/local/sundials/5.1.0/


for single-frequency-bin fixed coefficient test (isothermal Stromgren Sphere), we need to also modify the yml file:
    SPHM1RT:
        star_emission_rates: [1e-32, 2.34e11, 1e-32, 1e-32]     # (Optional) constant star emission rates (internal unit: energy/time) for each photon frequency group to use if use_constant_emission_rates is set. # = 5e48 photons/sec 
        coolingon:              0                           # (Optional) switch for cooling (and photoheating), but photo-ionization will be ongoing even if coolingon==0 
        useparams:              1                           # (Optional) switch to use thermo-chemistry parameters from the parameter file
        sigma_cross:            [8.13e-18, 1e-32, 1e-32] # (Conditional) (if useparams=1) The cross section of ionizing photons for hydrogen (cm^2)
        alphaB:                 2.59e-13                    # (Conditional) (if useparams=1) The case B recombination coefficient for hydrogen (cgs)
        beta:                   3.1e-16                   # (Conditional) (if useparams=1) The collisional ionization coefficient for hydrogen (cgs)


for multi-frequency hydrogen and helium Stromgren sphere test, we need to modify the yml file:
    SPHM1RT:
        init_mass_fraction_Hydrogen:  0.75                   # (Conditional) (if init_mass_fraction_metal != -1.0f) Inital mass fraction of particle mass in Hydrogen
        init_mass_fraction_Helium:    0.25                   # (Conditional) (if init_mass_fraction_metal != -1.0f) Inital mass fraction of particle mass in Helium
        init_species_abundance_HeI:      0.08333           # (Conditional) (if useabundances==1) HeI abundances (in unit hydrogen number density:nH)

    and in the initial condition makeIC.py, we should change:
    XH = 0.75  # hydrogen mass fraction
    XHe = 0.25  # hydrogen mass fraction


#if the radiation distribution is not spherical enough, we can turn on re-injection and increase the smoothing length of stars:
    SPHM1RT:
        reinject:               1                          # (Optional) gather energy around injection radius and re-inject the energy

    Stars:
        resolution_eta:       3.2348        # (Optional) Target smoothing length in units of the mean inter-particle separation (1.2348 == 48Ngbs with the cubic spline kernel). Defaults to the SPH value.




