Strömgen Sphere example in 3D
-----------------------------

This directory contains two examples in one:

    -   run a Strömgren sphere example, where a single central
        star ionizes the surrounding medium in a box.
        To run this example, use the provided `run.sh` script.
        This script will then make use of the `makeIC.py` and
        `plotSolution.py` script.

        There are a few variations:
    
        - `run_singlebin.sh`: single-frequency-bin static fixed temperature Stromgren Sphere with pure hydrogen

        - `run_MF.sh`: multifrequency static variable temperature Stromgren Sphere with pure hydrogen

        - `run_MFHHe.sh`: multifrequency static variable temperature Stromgren Sphere with hydrogen and helium


    -   run a propagation test of photons emitted from a single 
        central source in an otherwise uniform box.
        To run this example, use the provided `runPropagationTest.sh` script.
        This script will then make use of the `makePropagationTestIC.py` and
        `plotPhotonPropagationCheck.py` script.


Additional scripts:
    -   `plotRadiationProjection.py`: Plots a projection of the radiation
        quantities (energies, fluxes). NOTE: you might need to change the
        'snapshot_base' variable at the top of the script depending on which
        solutions you want to plot.

    -   `plotStromgren3DsinglebinCheck.py`: Plots the neutral fraction of a pure 
        hydrogen Stromgren Sphere with the grey approximation (single-frequency-bin),
        compared with an analytic solution

    -   `plotStromgren3DMFCheck.py`: Plots the neutral fraction and temperature of a pure 
        hydrogen Stromgren Sphere with three-frequency bins, compared
        with published solutions.

    -   `plotStromgren3DMFHHeCheck.py`: Plots the neutral fraction and temperature of a
        hydrogen (75%) and helium (25%) Stromgren Sphere with three-frequency bins, compared
        with published solutions.        

To use the GEAR RT model, compile with :
    --with-rt=GEAR_1 --with-rt-riemann-solver=GLF --with-hydro=gizmo-mfv --with-riemann-solver=hllc --with-stars=GEAR --with-feedback=none --with-grackle=$GRACKLE_ROOT

To use the SPHM1 RT model, compile with :
for propagation test:
    --with-rt=SPHM1RT_1 --with-stars=basic --with-feedback=none   --with-sundials=$SUNDIALS_ROOT

for Stromgren3D test:
    --with-rt=SPHM1RT_4 --with-stars=basic --with-feedback=none   --with-sundials=$SUNDIALS_ROOT

for Stromgren3D test without dynamics (no acceleration and no velocity):
    --with-rt=SPHM1RT_4 --with-stars=basic --with-feedback=none   --with-sundials=$SUNDIALS_ROOT --enable-boundary-particles=262145 --enable-fixed-boundary-particles=262145 

SUNDIALS_ROOT is the root directory that contains the lib and include directories, e.g. on cosma:
SUNDIALS_ROOT=/cosma/local/sundials/5.1.0/




